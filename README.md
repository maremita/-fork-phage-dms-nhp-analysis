# Macaque-human differences in SARS-CoV-2 Spike antibody response elicited by vaccination or infection
~~ abstract, authors, affiliations to go here ~~

## What is this?
This repository contains all of the data and code needed to recreate the analyses presented in the manuscript, "[manuscript title]".

## What is contained in each directory?

    code/
contains code to analyze the data and reproduce the figures in the manuscript. Most of the figures are generated by the R script, `phage_dms_nhp_plotting_code_SPIKE2.Rmd`. Plots related to escape profile comparisons are generated using [`python`](https://www.python.org/) via a few [`jupyter`](https://jupyter.org/) notebooks.

    data/
contains the data files in CSV format for input to the plotting and analysis scripts in the `code` directory.

    figures/
contains figure files, named as in the manuscript. See manuscript for figure legends. SPIKE1 and SPIKE2 are duplicate phage libraries, generated by independently cloning the oligo sequences into the phage vector, then amplifying the phage. Manuscript figures and analysis were performed using the SPIKE2 phage library. We also include versions of all figures made using data from the SPIKE1 library.

### Running the R script
The `.Rmd` file is intended to be run in [RStudio](https://www.rstudio.com/). We have used `RStudio 1.3.1093`.

### Running the `jupyter` notebooks
The `python` code depends on the [`numpy`](https://numpy.org/), [`pandas`](https://pandas.pydata.org/), [`xarray`](https://xarray.pydata.org/en/stable/), [`matplotlib`](https://matplotlib.org/), [Biopython](https://biopython.org/), [Python Optimal Transport](https://pythonot.github.io/), and [`jupyter`](https://jupyter.org/) packages. We have used `python 3.6.12`.

We provide a [conda](https://www.anaconda.com/) environment file to install the needed packages (and any other dependencies). For example, cloning this repository and setting up the environment can be done as follows:
	
    git clone https://github.com/matsengrp/phage-dms-nhp-analysis
    cd code
    conda env create -f environment.yml
    conda activate nhp-dms
    
The notebooks `plot_escape_compare_sims.ipynb` and `plot_sum_diff_sel.ipynb` reproduced Figs. 3A, 3B, 4A, 4B, 5A, 5B (for both SPIKE1 and SPIKE2 phage libraries).
